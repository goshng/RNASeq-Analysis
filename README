RNA-Seq Protocols and Analyses
==============================
Sang Chul Choi <goshng@yahoo.co.kr>

Histories
---------

Wed Jun 29 09:18:10 EDT 2011
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
One file of reads, +FASTQ06+, was not mapped onto the U159 reference genome. 
It makes sense because the sample strain of the reads file is from U138. Can I
use this file of reads for something such as genome construction? What is U138?
About half of the reads seemed to be mapped.


Tue Jun 28 13:56:07 EDT 2011
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The analysis of +smutans12+ consists of 12 reads files. One of the 12 files was
not successfully processed with *bwa-align*. +FASTQ11.sai+ was generated in the
swiftgen. It was copied to my Mac mahcine to do the rest of analyses.

To Do
-----


Directories
-----------
. doc
. pl
. src
. data
. resources
.. segemehl source code

Goal
----
I want to know how to analyze RNA-Seq data of prokaryotes.

Sequencing Platforms
--------------------
Illumina platform

Test Study
----------
[Sharma et al. 2010] is used as a case study.
The raw data set is stored in NCBI with accession SRP001481.

[literal]
ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP001/SRP001481

Genome
~~~~~~
_H. pylori_ 26695 genome is used as a reference genome.
[literal]
/Volumes/Elements/Documents/Projects/mauve/bacteria/Helicobacter_pylori_26695_uid57787/NC_000915.gbk

FASTQ format
~~~~~~~~~~~~
The raw data sets from SRA could not be the original data files from sequencers.
fastx\_toolkit may be useful in preprocessing fastq format files.

A quality control tool. This is a useful tool to see the content of a FASTQ
file. See the website
http://www.bioinformatics.bbsrc.ac.uk/projects/fastqc/
for further detail.
This can be downloaded at
http://www.bioinformatics.bbsrc.ac.uk/projects/download.html#fastqc.
A video tutorial of fastqc was found at
http://www.youtube.com/watch?v=bz93ReOv87Y.
Its documentation can be found at
http://www.bioinformatics.bbsrc.ac.uk/projects/fastqc/Help/.

SeqMonk
~~~~~~~
This is a way to create a custom genome using *seqmonk*,
http://www.bioinformatics.bbsrc.ac.uk/projects/seqmonk/CREATING_CUSTOM_GENOMES.txt

You can click EMBL at Gene sets
http://www.ebi.ac.uk/integr8/FtpSearch.do?orgProteomeId=23&geneId=6901605

An example
^^^^^^^^^^

I do not know which file I should use.

http://www.ebi.ac.uk/integr8/FtpSearch.do?orgProteomeId=23&currentclicked=DOWNLOADS

How to download EMBL genome for seqmonk
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

. Go to http://www.ebi.ac.uk/
. Search EBI for species name and its unique number (e.g., Helicobacter pylori
26695)
. Find _complete genome_ in the search result and click a link next to it.
. Click _TEXT_ next to _Download_ in the website.
. Replace product with description, and locus_tag with name.


Genome Reviews

FastQC
------
A nice tool for examming FASTQ files.

``PRINSEQ'' seems to be also useful.
[literal]
http://prinseq.sourceforge.net/manual.html

Viewers
~~~~~~~
Find some useful viewers at
[literal]
http://seqanswers.com/forums/showthread.php?t=3904
http://seqanswers.com/forums/showthread.php?t=3779


From Steve Hoffmann
^^^^^^^^^^^^^^^^^^^
Dear Sang Chul,

thank you very much for your Mail. The word "computed" sounds a bit like rocket
science, but it is absolutely not! We have used a simple perl script to generate
the files for the IGB Browser. The IGB format essentially boils down to a simple
XYZ file, where X is the position, Y is the expression on the forward and Z is
the expression on the reverse strand. Please check the IGB file formats to find
the one that is most suitable for you. For the output 

SRR031223.15 12  104 0.0000  20  123 116 9 2 1 + 96928 97053 >NC_000915.1
S1;M1;S2;M2;S2;M2;S1;M1;S1;M1;S1;M2;I1;M1;S1;M104;D2;M     2;


the columns "+ 96928 97053 >NC_000915.1" contain all the coordinates you need to
generate an XYZ file. You can extract them by  grep-ing the tab separated
columns 11, 12, 13, and 14. In the example above "+" is the strand, "96928" is
the start and "97053" is the end of the match. "NC_000915.1" is the chromosome
or reference sequence. 

In practice the segemehl file should be sorted according to the position in a
first step. In a second step a simple linear scan you can now add up the matches
for all positions in the chromosome/reference sequence for the plus and minus
strand separately. 

Additionally i recommend a normalization on the number of hits. If for example
the read SRR031223.15 has 4 alternative hits in the genome i'd recommend to add
a quarter match to each position but a full match. If you want to compare
library id also recommend to do a normalization based on the library size.

Hope that i was able to help you a little!

Cheers!
Steve

How to compute graphs!
~~~~~~~~~~~~~~~~~~~~~~
Find numbers of hits for each read. Prepare two arrays of size being equal to
the number of nucleotides of a reference genome. Reset all the elements of the
arrays to zero. One of arrays is for the leading strand and another for the
lagging strand. For each map of a read, locate the range of the map to increase
the position of the array depending on strand by 1/hits where hits is the number
of multiple hits of the read. Repeat this procedure for all the mapped reads.
The two arrays are the result of the graph computation algorithm.

IGB seems useful.
-----------------
I did not find IGV useful as its website claims.  IGB seems more useful than
IGB.  I want to know to draw genes and ORF and some other genome annotations in
IGB.  The genbank file can be used to list genes.  A list of genes may be
drawn in parallel with short read maps.

Genbank H. pylori genome contains gff file as well as gbk file. The gff file can
be used as an annotation file for IGB.  But, gene names do not appear in boxes
of annotation tracks. It would be good to control display of annotation boxes
somehow.

Wiggle and Track
----------------
Place a wiggle file at +public_html+ of my swiftgen account.

http://strep-genome.bscb.cornell.edu/cgi-bin/hgTracks?db=SmuUA159&position=chr1&hgt.customText=http://compgen.bscb.cornell.edu/~choi/SRR031130.map.wig


Interesting sites
-----------------

infernal RFAM:
http://strep-genome.bscb.cornell.edu/cgi-bin/hgTracks?insideX=148&revCmplDisp=0&hgsid=124&hgt_doJsCommand=&hgt.right1=+%3E+&position=chr1%3A1127041-1152113&hgtgroup_user_close=0&hgtgroup_map_close=0&hgtgroup_genes_close=0&hgtgroup_regulation_close=0&hgtgroup_varRep_close=0[Link]


Mapped reads
------------
FASTQ: FASTQ01
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_001_10250297_C00RHABXX_s_3_sequence.txt.gz
The total number of short reads is 18931854
The number of mapped reads is  13102917 (69 %)
FASTQ: FASTQ02
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_001_10250297_C00RHABXX_s_4_sequence.txt.gz
The total number of short reads is 19747584
The number of mapped reads is  10326492 (52 %)
FASTQ: FASTQ03
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_002_10250297_C00RHABXX_s_3_sequence.txt.gz
The total number of short reads is 20591432
The number of mapped reads is  13494893 (65 %)
FASTQ: FASTQ04
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_002_10250297_C00RHABXX_s_4_sequence.txt.gz
The total number of short reads is 24918598
The number of mapped reads is  11017699 (44 %)
FASTQ: FASTQ05
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_003_10250297_C00RHABXX_s_3_sequence.txt.gz
The total number of short reads is 22534482
The number of mapped reads is  11751227 (52 %)
FASTQ: FASTQ06
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_003_10250297_C00RHABXX_s_4_sequence.txt.gz
The total number of short reads is 19483712
The number of mapped reads is   102150 (0 %)
FASTQ: FASTQ07
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_004_10250297_C00RHABXX_s_3_sequence.txt.gz
The total number of short reads is 22194404
The number of mapped reads is  12060475 (54 %)
FASTQ: FASTQ08
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_004_10250297_C00RHABXX_s_4_sequence.txt.gz
The total number of short reads is 21131873
The number of mapped reads is  10866409 (51 %)
FASTQ: FASTQ09
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_005_10250297_C00RHABXX_s_3_sequence.txt.gz
The total number of short reads is 20482548
The number of mapped reads is  10596559 (51 %)
FASTQ: FASTQ10
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_005_10250297_C00RHABXX_s_4_sequence.txt.gz
The total number of short reads is 22392326
The number of mapped reads is  10750003 (48 %)
FASTQ: FASTQ11
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_006_10250297_C00RHABXX_s_3_sequence.txt.gz

gzip:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_006_10250297_C00RHABXX_s_3_sequence.txt.gz:
decompression OK, trailing garbage ignored
The total number of short reads is 22160808
The number of mapped reads is  15192418 (68 %)
FASTQ: FASTQ12
FILE:
/Volumes/Elements/Documents/Projects/rnaseq/data/smutans/demulti_006_10250297_C00RHABXX_s_4_sequence.txt.gz
The total number of short reads is 20264101
The number of mapped reads is  11156784 (55 %)

Tools for differential expression
---------------------------------

See the following 
https://djfextranet.agrsci.dk/sites/phd_cource/public/Documents/course%20material/Module_10_NGS_analysis.pdf[PPT]
for discussion of the tools for differential expression.

edgeR
~~~~~

DESeq
~~~~~

http://www-huber.embl.de/users/anders/DESeq/

DEGseq
~~~~~~
Two versions of DEGseq were found. One of them was found at either
http://www.bioconductor.org/packages/release/bioc/html/DEGseq.html[Version1]
or
http://www.bioconductor.org/packages/2.5/bioc/html/DEGseq.html[Version2.5].
Another version was found and could be installed using the following R command:
.The first method that I used to install DEGseq.
----
source("http://bioinfo.au.tsinghua.edu.cn/software/degseq/DEGseqInstall.R")
----
The first seemed to be newer, and was installed using the following R command:
.The second method that I used to install DEGseq.
----
source("http://www.bioconductor.org/biocLite.R")
biocLite("DEGseq")
----

DEGexp function argments were different.

A discussion thread for installing DEGseq was found 
http://seqanswers.com/forums/showthread.php?t=2952[here].

A discussion thread about the error in the tutorial can be found
http://seqanswers.com/forums/showthread.php?t=2952&page=3[here].

Another thread was found
http://seqanswers.com/forums/showthread.php?t=2952&page=5[here].

baySeq
~~~~~~
Another
